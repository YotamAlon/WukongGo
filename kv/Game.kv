#:import ConfirmPopup Views.Fragments.ConfirmPopup

<Piece>:
    on_press:
        app.controller.process_move(self.index)
    background_color: 0, 0, 0, 0
    canvas.before:
        Color:
            rgb: 0, 0, 0, 1
        Line:
            id: horizontal_line
            points: (root.pos[0] + (root.size[0] / 2) if root.index[1] == 1 else root.pos[0], root.pos[1] + (root.size[1] / 2), root.pos[0] + (root.size[0] / 2) if root.index[1] == root.board_size else root.pos[0] + root.size[0], root.pos[1] + (root.size[1] / 2))
        Line:
            id: vertical_line
            points: (root.pos[0] + (root.size[0] / 2), root.pos[1] + (root.size[1] / 2) if root.index[0] == root.board_size else root.pos[1], root.pos[0] + (root.size[0] / 2), root.pos[1] + (root.size[1] / 2) if root.index[0] == 1 else root.pos[1] + root.size[1])
    Image:
        source: 'assets/images/' + root.color + '.png'
        pos: root.pos
        size: root.size


<GameBoard>:
    canvas:
        BorderImage:
            source: 'assets/images/board.png'
            pos: self.pos
            size: self.size

    cols: root.board_size
    rows: root.board_size
    orientation: 'vertical'


<GameScreen>:
    board_container: board_container
    score_board: score_board_id
    player_1_label: player_1_label_id
    player_2_label: player_2_label_id
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            canvas.before:
                Color:
                    rgba: 0.5, 0.5, 0.5, 1
                Rectangle:
                    size: self.size
                    pos: self.pos
            orientation: 'horizontal'
            size_hint_y: None
            Label:
                id: player_1_label_id
                text: 'Black: Player 1'
                color: 1, 0, 0, 1
            Label:
                id: score_board_id
                text: root.score
                color: 0, 1, 0, 1
            Label:
                id: player_2_label_id
                text: 'White: Player 2'
                color: 0, 0, 1, 1
        BoxLayout:
            RelativeLayout:
                id: board_container
                size_hint: None, None
                size: min(self.parent.size), min(self.parent.size)
                pos: self.parent.pos[0] + ((self.parent.size[0] - self.size[0]) / 2), self.pos[1]
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            Button:
                text: 'Go back to menu'
                size_hint_y: None
                on_release: root.navigate('menu')
            Button:
                text: 'Pass'
                size_hint_y: None
                on_release: app.controller.pass_turn()
            Button:
                text: 'Resign'
                size_hint_y: None
                on_release: self.popup.open()
                popup: ConfirmPopup(title='Are you sure you want to resign?', text='This will cause you to lose.', callback=app.controller.resign)